name: ORG WG Notifications

on:
  issues:
    types: [opened, edited, closed]
  issue_comment:
    types: [created]
  pull_request:
    types: [opened, closed]

jobs:
  discord:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord notification
        uses: Ilshidur/action-discord@master
        with:
          args: |
            {% if github.event_name == 'issues' and github.event.action == 'opened' %}
            üìù **[ORG WG] New Proposal Submitted**
            Title: ${{ github.event.issue.title }}
            Author: ${{ github.actor }}
            Link: ${{ github.event.issue.html_url }}

            {% elif github.event_name == 'issue_comment' %}
            üí¨ **[ORG WG] Proposal Comment**
            Proposal: ${{ github.event.issue.title }}
            Comment by: ${{ github.actor }}
            Comment: ${{ github.event.comment.body }}
            Link: ${{ github.event.comment.html_url }}

            {% elif github.event_name == 'pull_request' and github.event.action == 'closed' and github.event.pull_request.merged == true %}
            ‚úÖ **[ORG WG] Proposal Approved & Merged**
            Title: ${{ github.event.pull_request.title }}
            Merged by: ${{ github.actor }}
            Link: ${{ github.event.pull_request.html_url }}

            {% else %}
            üì¢ **[ORG WG] Event:** ${{ github.event_name }} - ${{ github.event.action }}
            Repo: ${{ github.repository }}
            {% endif %}
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
